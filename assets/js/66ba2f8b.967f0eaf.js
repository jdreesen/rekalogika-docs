"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[1624],{1296:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var a=t(5893),r=t(1151),o=t(4866),s=t(5162);const l={title:"Introduction & Installation"},i=void 0,c={id:"mapper/intro",title:"Introduction & Installation",description:"rekalogika/mapper is an object mapper for PHP and Symfony, also commonly known",source:"@site/docs/mapper/00-intro.md",sourceDirName:"mapper",slug:"/mapper/intro",permalink:"/mapper/intro",draft:!1,unlisted:!1,editUrl:"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/mapper/00-intro.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{title:"Introduction & Installation"},sidebar:"docs",previous:{title:"rekalogika/mapper",permalink:"/mapper/"},next:{title:"Basic Usage",permalink:"/mapper/usage"}},u={},d=[{value:"Synopsis",id:"synopsis",level:2},{value:"Why Use a Mapper?",id:"why-use-a-mapper",level:2},{value:"Features",id:"features",level:2},{value:"Future Features",id:"future-features",level:2},{value:"Installation",id:"installation",level:2},{value:"License",id:"license",level:2},{value:"Contributing",id:"contributing",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"rekalogika/mapper"})," is an object mapper for PHP and Symfony, also commonly known\nas an automapper. It maps an object to another object. It removes the complexity\nof mapping an object to another object, and even an object graph to another\nobject graph."]}),"\n",(0,a.jsx)(n.h2,{id:"synopsis",children:"Synopsis"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"use App\\Entity\\Book;\nuse Rekalogika\\Mapper\\MapperInterface;\n\n/** @var MapperInterface $mapper */\n/** @var Book $book */\n\n$result = $mapper->map($book, BookDto::class);\n\n// or map to an existing object\n\n$bookDto = new BookDto();\n$mapper->map($book, $bookDto);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"why-use-a-mapper",children:"Why Use a Mapper?"}),"\n",(0,a.jsx)(n.p,{children:"Why do we need to use a mapper to save a few keystrokes, and not just use\nsomething simple like this?"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"class BookDto\n{\n    public static function create(Book $book): self\n    {\n        $dto = new self();\n        // ...\n\n        return $dto;\n    }\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"Everyone must have that idea at some point. However, as the project grows, the\ntarget classes (DTOs) may start to reference each other, and become a rich\nobject graph. Your code will start to have many special cases, and is no longer\nas simple as you thought it would be. It becomes harder to maintain, and then\nyou eventually sit back and try to resolve the problem. If successful, you will\nend up with something that resembles a mapping framework anyway."}),"\n",(0,a.jsx)(n.p,{children:"Mapping can be simple, but can also become a highly complex task. A mapper is\ncreated out of necessity to handle the complexity, not just a means of saving a\nfew keystrokes."}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Automatically lists the properties of the source and target, detects their\ntypes, and maps them accordingly."}),"\n",(0,a.jsx)(n.li,{children:"By default, does not attempt to circumvent your class constraints. Reads only\nfrom and writes only to public properties, getters, setters. Does not\ninstantiate objects without their constructor."}),"\n",(0,a.jsx)(n.li,{children:"Override the mapping logic using a custom property mapper."}),"\n",(0,a.jsx)(n.li,{children:"Constructor initialization."}),"\n",(0,a.jsx)(n.li,{children:"Handles nested objects."}),"\n",(0,a.jsx)(n.li,{children:"Handles recursion and circular references."}),"\n",(0,a.jsx)(n.li,{children:"Inheritance support. Maps to abstract classes and interfaces using an\ninheritance map attribute."}),"\n",(0,a.jsx)(n.li,{children:"Reads the type from PHP type declaration and PHPDoc annotations, including\nthe type of the nested objects."}),"\n",(0,a.jsx)(n.li,{children:"If possible, target objects are lazy-loaded. The mapping does not take place\nuntil the target is accessed."}),"\n",(0,a.jsx)(n.li,{children:"Attempts to detect identifier properties on the source side. Those properties\non the target side will be mapped eagerly, and will not trigger the hydration.\nThus, API Platform will be able to generate IRIs without causing the hydration\nof the entire object graph."}),"\n",(0,a.jsxs)(n.li,{children:["Handles the mapping between ",(0,a.jsx)(n.code,{children:"array"})," or array-like objects, as well as using an\nadder method."]}),"\n",(0,a.jsxs)(n.li,{children:["Handles non-string & non-integer keys in array-like objects, including\n",(0,a.jsx)(n.code,{children:"SplObjectStorage"}),"."]}),"\n",(0,a.jsx)(n.li,{children:"Lazy loading & lazy stream mapping with collection types. Consumes less memory\n& avoids hydrating a Doctrine collection prematurely."}),"\n",(0,a.jsxs)(n.li,{children:["With lazy loading, if the source is a ",(0,a.jsx)(n.code,{children:"Countable"}),", then the target will also\nbe a ",(0,a.jsx)(n.code,{children:"Countable"}),". With an extra-lazy Doctrine Collection, the consumer will be\nable to count the target without causing a full hydration of the source."]}),"\n",(0,a.jsx)(n.li,{children:"Manual mapping using a class method."}),"\n",(0,a.jsx)(n.li,{children:"Easy to extend by creating new transformers, or decorating the existing ones."}),"\n",(0,a.jsx)(n.li,{children:"Match classes using attributes in your transformers, in addition to using\nclass names."}),"\n",(0,a.jsx)(n.li,{children:"Helpful exception messages."}),"\n",(0,a.jsx)(n.li,{children:"Console commands for debugging."}),"\n",(0,a.jsx)(n.li,{children:"Data collector and profiler integration."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"future-features",children:"Future Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Option to read & write to private properties."}),"\n",(0,a.jsxs)(n.li,{children:["Option to inject ",(0,a.jsx)(n.code,{children:"Context"})," and ",(0,a.jsx)(n.code,{children:"MainTransformer"})," to a property mapper."]}),"\n",(0,a.jsx)(n.li,{children:"Data collector and profiler integration."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsxs)(n.p,{children:["Make sure Composer is installed globally, as explained in the\n",(0,a.jsx)(n.a,{href:"https://getcomposer.org/doc/00-intro.md",children:"installation chapter"}),"\nof the Composer documentation."]}),"\n",(0,a.jsxs)(o.Z,{children:[(0,a.jsxs)(s.Z,{value:"flex",label:"With Symfony Flex",children:[(0,a.jsx)(n.p,{children:"Open a command console, enter your project directory, and execute:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"composer require rekalogika/mapper\n"})})]}),(0,a.jsxs)(s.Z,{value:"noflex",label:"Without Symfony Flex",children:[(0,a.jsx)(n.p,{children:"Step 1: Download the Bundle"}),(0,a.jsx)(n.p,{children:"Open a command console, enter your project directory, and execute the\nfollowing command to download the latest stable version of this bundle:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"composer require rekalogika/mapper\n"})}),(0,a.jsx)(n.p,{children:"Step 2: Enable the Bundle"}),(0,a.jsxs)(n.p,{children:["Then, enable the bundle by adding it to the list of registered bundles\nin the ",(0,a.jsx)(n.code,{children:"config/bundles.php"})," file of your project:"]}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",metastring:"title=config/bundles.php",children:"return [\n    // ...\n    Rekalogika\\Mapper\\RekalogikaMapperBundle::class => ['all' => true],\n];\n"})})]}),(0,a.jsxs)(s.Z,{value:"nonsymfony",label:"Non-Symfony Projects",children:[(0,a.jsx)(n.p,{children:"Open a command console, enter your project directory, and execute:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"composer require rekalogika/mapper\n"})}),(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsx)(n.p,{children:"Many parts of this documentation assume you are using Symfony, and will need\nto be done differently in non-Symfony projects."})})]})]}),"\n",(0,a.jsx)(n.h2,{id:"license",children:"License"}),"\n",(0,a.jsx)(n.p,{children:"MIT"}),"\n",(0,a.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,a.jsxs)(n.p,{children:["Issues and pull requests should be filed in the GitHub repository\n",(0,a.jsx)(n.a,{href:"https://github.com/rekalogika/mapper",children:"rekalogika/mapper"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},5162:(e,n,t)=>{t.d(n,{Z:()=>s});t(7294);var a=t(6905);const r={tabItem:"tabItem_Ymn6"};var o=t(5893);function s(e){let{children:n,hidden:t,className:s}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.Z)(r.tabItem,s),hidden:t,children:n})}},4866:(e,n,t)=>{t.d(n,{Z:()=>k});var a=t(7294),r=t(6905),o=t(2466),s=t(6550),l=t(469),i=t(1980),c=t(7392),u=t(12);function d(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:a,default:r}}=e;return{value:n,label:t,attributes:a,default:r}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const r=(0,s.k6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,i._X)(o),(0,a.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(r.location.search);n.set(o,e),r.replace({...r.location,search:n.toString()})}),[o,r])]}function b(e){const{defaultValue:n,queryString:t=!1,groupId:r}=e,o=p(e),[s,i]=(0,a.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:o}))),[c,d]=m({queryString:t,groupId:r}),[b,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,o]=(0,u.Nk)(t);return[r,(0,a.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:r}),g=(()=>{const e=c??b;return h({value:e,tabValues:o})?e:null})();(0,l.Z)((()=>{g&&i(g)}),[g]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),f(e)}),[d,f,o]),tabValues:o}}var f=t(2389);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(5893);function j(e){let{className:n,block:t,selectedValue:a,selectValue:s,tabValues:l}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.o5)(),u=e=>{const n=e.currentTarget,t=i.indexOf(n),r=l[t].value;r!==a&&(c(n),s(r))},d=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:a===n?0:-1,"aria-selected":a===n,ref:e=>i.push(e),onKeyDown:d,onClick:u,...o,className:(0,r.Z)("tabs__item",g.tabItem,o?.className,{"tabs__item--active":a===n}),children:t??n},n)}))})}function x(e){let{lazy:n,children:t,selectedValue:r}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function v(e){const n=b(e);return(0,y.jsxs)("div",{className:(0,r.Z)("tabs-container",g.tabList),children:[(0,y.jsx)(j,{...e,...n}),(0,y.jsx)(x,{...e,...n})]})}function k(e){const n=(0,f.Z)();return(0,y.jsx)(v,{...e,children:d(e.children)},String(n))}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>s});var a=t(7294);const r={},o=a.createContext(r);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);