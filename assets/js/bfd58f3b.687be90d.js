"use strict";(self.webpackChunkrekalogika_docs=self.webpackChunkrekalogika_docs||[]).push([[5914],{7466:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>s,default:()=>m,frontMatter:()=>p,metadata:()=>o,toc:()=>c});var n=t(5893),a=t(1151);const p={title:"Mapping Object to Object"},s=void 0,o={id:"mapper/object",title:"Mapping Object to Object",description:"Mapping an object to another object is the most common task done by a mapper.",source:"@site/docs/mapper/02-object.md",sourceDirName:"mapper",slug:"/mapper/object",permalink:"/mapper/object",draft:!1,unlisted:!1,editUrl:"https://github.com/rekalogika/rekalogika-docs/edit/main/docs/mapper/02-object.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Mapping Object to Object"},sidebar:"docs",previous:{title:"Basic Usage",permalink:"/mapper/usage"},next:{title:"Mapping Arrays & Array-Like Objects",permalink:"/mapper/collection"}},i={},c=[{value:"How It Works",id:"how-it-works",level:2},{value:"Custom Property Mapper",id:"custom-property-mapper",level:2},{value:"Shorthand Using <code>AsPropertyMapper</code> Attached to the Class",id:"shorthand-using-aspropertymapper-attached-to-the-class",level:3},{value:"Property Name Magic",id:"property-name-magic",level:3},{value:"Extra Arguments",id:"extra-arguments",level:3},{value:"Manual Wiring",id:"manual-wiring",level:3},{value:"Dumping Property Mapper Table",id:"dumping-property-mapper-table",level:3}];function l(e){const r={admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.p,{children:["Mapping an object to another object is the most common task done by a mapper.\nInternally, this task is done by ",(0,n.jsx)(r.code,{children:"ObjectToObjectTransformer"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,n.jsx)(r.p,{children:"The mapper identifies properties that have the same name on the source and the\ntarget side. It looks at public properties, public getters & setters, and\nconstructor arguments. It then transforms each source value to the target type,\nand either sets the target property or adds it to the constructor arguments."}),"\n",(0,n.jsx)(r.h2,{id:"custom-property-mapper",children:"Custom Property Mapper"}),"\n",(0,n.jsxs)(r.p,{children:["If you need a custom mapping logic for a specific property, you can create a\nservice and add the attribute ",(0,n.jsx)(r.code,{children:"AsPropertyMapper"})," to a custom method."]}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsx)(r.p,{children:"This is optional. You only need to use this if you need a custom logic to\npopulate a specific target property."})}),"\n",(0,n.jsx)(r.p,{children:"Example:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-php",children:"use Rekalogika\\Mapper\\PropertyMapper\\AsPropertyMapper;\n\nclass UserMapper\n{\n    #[AsPropertyMapper(\n        targetClass: UserDto::class,\n        property: 'name',\n    )]\n    public function mapName(User $user): string\n    {\n        return strtoupper($user->getFirstName() . ' ' . $user->getLastName());\n    }\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["The above example concatenates first name and last name from the source ",(0,n.jsx)(r.code,{children:"User"}),"\nobject, transforms it to uppercase, and returns the result. Mapper will then\nassign the result to the ",(0,n.jsx)(r.code,{children:"name"})," property of the target ",(0,n.jsx)(r.code,{children:"UserDto"})," object, as\nspecified in the arguments of the ",(0,n.jsx)(r.code,{children:"AsPropertyMapper"})," attribute."]}),"\n",(0,n.jsxs)(r.h3,{id:"shorthand-using-aspropertymapper-attached-to-the-class",children:["Shorthand Using ",(0,n.jsx)(r.code,{children:"AsPropertyMapper"})," Attached to the Class"]}),"\n",(0,n.jsxs)(r.p,{children:["If you have many properties to manually map, you can put the ",(0,n.jsx)(r.code,{children:"AsPropertyMapper"}),"\nattribute on the class, and it will apply to all methods in the class. Example:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-php",children:"use Rekalogika\\Mapper\\PropertyMapper\\AsPropertyMapper;\n\n#[AsPropertyMapper(targetClass: UserDto::class)]\nclass UserMapper\n{\n    #[AsPropertyMapper('name')]\n    public function mapName(User $user): string\n    {\n        return strtoupper($user->getFirstName() . ' ' . $user->getLastName());\n    }\n\n    #[AsPropertyMapper('birthDate')]\n    public function mapBirthDate(User $user): string\n    {\n        return $user->getBirthDate()->format('Y-m-d');\n    }\n\n    #[AsPropertyMapper('email')]\n    public function mapEmail(User $user): string\n    {\n        return $user->getEmailAddress();\n    }\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"property-name-magic",children:"Property Name Magic"}),"\n",(0,n.jsx)(r.p,{children:"For even more shorthand, you can omit the property name altogether, and the\nmapper will use the method name, stripping the leading 'map' and lowercasing\nthe first letter."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-php",children:"use Rekalogika\\Mapper\\PropertyMapper\\AsPropertyMapper;\n\n#[AsPropertyMapper(targetClass: UserDto::class)]\nclass UserMapper\n{\n    // maps to 'name'\n    #[AsPropertyMapper]\n    public function mapName(User $user): string\n    {\n        return strtoupper($user->getFirstName() . ' ' . $user->getLastName());\n    }\n\n    // maps to 'birthDate'\n    #[AsPropertyMapper]\n    public function mapBirthDate(User $user): string\n    {\n        return $user->getBirthDate()->format('Y-m-d');\n    }\n\n    // maps to 'email\n    #[AsPropertyMapper]\n    public function mapEmail(User $user): string\n    {\n        return $user->getEmailAddress();\n    }\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"extra-arguments",children:"Extra Arguments"}),"\n",(0,n.jsx)(r.p,{children:"You also have the option to inject the main transformer, sub-mapper, and the\ncontext to the property mapper. This can be in any order, but the first argument\nmust be the source object."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-php",children:"use Rekalogika\\Mapper\\Context\\Context;\nuse Rekalogika\\Mapper\\MainTransformerInterface;\nuse Rekalogika\\Mapper\\PropertyMapper\\AsPropertyMapper;\nuse Rekalogika\\Mapper\\SubMapper\\SubMapperInterface;\n\n#[AsPropertyMapper(targetClass: UserDto::class)]\nclass UserMapper\n{\n    #[AsPropertyMapper]\n    public function mapName(\n        User $user,\n        // highlight-start\n        MainTransformerInterface $mainTransformer,\n        SubMapperInterface $subMapper,\n        Context $context\n        // highlight-end\n    ): string {\n        return strtoupper($user->getFirstName() . ' ' . $user->getLastName());\n    }\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"manual-wiring",children:"Manual Wiring"}),"\n",(0,n.jsx)(r.p,{children:"If you don't use autowiring, autoconfiguration, or don't want to use attributes,\nyou can add the service manually like this:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",metastring:'title="config/services.yaml"',children:"services:\n    App\\Mapper\\UserMapper:\n        tags:\n            -\n                name: 'rekalogika.mapper.property_mapper'\n                method: 'mapName'\n                sourceClass: 'App\\Entity\\User'\n                targetClass: 'App\\Dto\\UserDto'\n                property: 'name'\n            -\n                name: 'rekalogika.mapper.property_mapper'\n                method: 'mapBirthDate'\n                sourceClass: 'App\\Entity\\User'\n                targetClass: 'App\\Dto\\UserDto'\n                property: 'birthDate'\n            -\n                name: 'rekalogika.mapper.property_mapper'\n                method: 'mapEmail'\n                sourceClass: 'App\\Entity\\User'\n                targetClass: 'App\\Dto\\UserDto'\n                property: 'email'\n"})}),"\n",(0,n.jsx)(r.h3,{id:"dumping-property-mapper-table",children:"Dumping Property Mapper Table"}),"\n",(0,n.jsx)(r.p,{children:"To dump the list of all property mappers, run the following command:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"$ bin/console debug:container --tag=rekalogika.mapper.property_mapper\n"})})]})}function m(e={}){const{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},1151:(e,r,t)=>{t.d(r,{Z:()=>o,a:()=>s});var n=t(7294);const a={},p=n.createContext(a);function s(e){const r=n.useContext(p);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(p.Provider,{value:r},e.children)}}}]);